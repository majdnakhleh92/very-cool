local darius = loadstring(game:HttpGetAsync("https://raw.githubusercontent.com/idonthaveoneatm/darius/refs/heads/main/bundled.luau"))()
local hubName = "Garof ServerHopper"
local HttpService = game:GetService("HttpService")

local Settings = {}
makefolder(hubName)

function SaveSettings()
	local JSON = HttpService:JSONEncode(Settings)
	writefile(hubName .. "\\configName.cfg", JSON)
end

function LoadSettings()
	if isfile(hubName .. "\\configName.cfg") then
		Settings = HttpService:JSONDecode(readfile(hubName .. "\\configName.cfg"))
	end
end

LoadSettings()

local window = darius:Window({
	Title = hubName,
	Description = "Garof's serverhopper configurations",
	HideBind = Enum.KeyCode.X,

	Icon = "",
	UseConfig = false,
	Workspace = "mainWorkspace",
	IsMobile = game:GetService("UserInputService").TouchEnabled and not game:GetService("UserInputService").KeyboardEnabled,
	Theme = {
		Name = "dont care that much",
		Colors = {
			background = Color3.fromHex("#1C1726"),
			background2 = Color3.fromHex("#0F0C15"),

			text = Color3.fromHex("#EDEBF2"),
			text2 = Color3.fromHex("#B7A6D4"),

			selectedTab = Color3.fromHex("#1D1827"),

			colorpickerBar = Color3.fromHex("#DCE1E5"),

			notificationButton = Color3.fromHex("#222427"),

			mobileButtonBackground = Color3.fromHex("#DCE1E5"),
			mobileButtonText = Color3.fromHex("#2C2F33"),
			mobileButtonImage = Color3.fromHex("#2C2F33"),

			disabledBackground = Color3.fromHex("#2A2C31"),
			disabledText = Color3.fromHex("#D6DCE0"),

			toggled = Color3.fromHex("#B7A6D4"),

			red = Color3.fromHex("#B7A6D4"),
			orange = Color3.fromHex("#B7A6D4")
		},
	}})

local function Notification(Title, Body)
	darius:Notify({
		Title = Title or "",
		Body = Body or "",
		Duration = 5,

	})
end

local function ParseNumber(str)
	str = tostring(str):gsub("%s+", ""):lower()

	local number, suffix = string.match(str, "^(%d*%.?%d+)([kmb]?)$")

	if not number then
		return nil
	end

	local value = tonumber(number)
	if not value then
		return nil
	end

	if suffix == "k" then
		value = value * 1000
	elseif suffix == "m" then
		value = value * 1000000
	elseif suffix == "b" then
		value = value * 1000000000
	end

	return value
end

local function updateParagraph(paragraph, list)
	paragraph:SetBody(table.concat(list, ", "))
end

local function Color3ToHex(color)
	local r = math.floor(color.R * 255)
	local g = math.floor(color.G * 255)
	local b = math.floor(color.B * 255)
	return bit32.bor(bit32.lshift(r, 16), bit32.lshift(g, 8), b)
end

local function HexToColor3(hex)
	local r = bit32.rshift(bit32.band(hex, 0xFF0000), 16) / 255
	local g = bit32.rshift(bit32.band(hex, 0x00FF00), 8) / 255
	local b = bit32.band(hex, 0x0000FF) / 255
	return Color3.new(r, g, b)
end

local Serverhop = window:Tab({
	Name = "Serverhop",

	Image = ""
})

local serverhopButton = Serverhop:Button({
	Name = "Start Serverhop",
	Callback = function()
		loadstring(game:HttpGet("https://raw.githubusercontent.com/majdnakhleh92/very-cool/refs/heads/main/script"))()
	end,
})

Serverhop:Divider()

local HubToLoad = Serverhop:TextBox({
	Name = "Hub to Load",
	Callback = function(value): string
		local url = value:match('https?://[^%s"\'%)]+')

		if url then
			Settings["HubtoLoad"] = url
		else
			Notification("Invalid Loadstring!", "make sure the URL inside the loadstring is valid.")
		end
	end,

	OnLeave = true,
	ClearTextOnFocus = false,
	PlaceHolderText = 'loadstring(game:HttpGet("https://raw.githubusercontent.com/majdnakhleh92/very-cool/refs/heads/main/script.lua.txt"))()'
})

Serverhop:Divider()

local save = Serverhop:Button({
	Name = "Save Settings",
	Callback = function()
		SaveSettings()

		Notification("Settings Saved!", "")
	end,
})

local configurations = window:Tab({
	Name = "configurations",

	Image = ""
})

local moneyPerSecond = configurations:TextBox({
	Name = "Minimum Money Per Second",
	Callback = function(value): string
		value = value:gsub("_", "")
		local filtered = ParseNumber(value)
		if filtered then
			Settings["MoneyPerSecond"] = filtered
			Notification("Success!", "Minimum Money Per Second set to " .. filtered)
		else
			Notification("Invalid Number!", "make sure the number is valid")
		end
	end,

	FLAG = "$/stextbox",
	OnlyNumbers = false,
	OnLeave = true,
	ClearTextOnFocus = false,
	PlaceHolderText = "100m or 10k"
})

configurations:Divider()

local label14 = configurations:Label("Select a region to prioritize - this does not mean it will ignore servers that are not prioritized") 

local dropdown = configurations:Dropdown({
	Name = "Region Priority",
	Items = {
		"New York, USA",
		"Ashburn, Virginia, USA",
		"Chicago, USA",
		"Atlanta, USA",
		"Miami, USA",
		"Dallas, Texas, USA",
		"Los Angeles, California, USA",
		"San Jose / Palo Alto, California, USA",
		"Seattle, Washington, USA",

		"London, United Kingdom",
		"Frankfurt, Germany",
		"Amsterdam, Netherlands",
		"Paris, France",
		"Warsaw, Poland",
		"Stockholm, Sweden",
		"Copenhagen, Denmark",
		"Helsinki, Finland",
		"Zurich, Switzerland",
		"Madrid, Spain",

		"Tokyo, Japan",
		"Singapore",
		"Seoul, South Korea",
		"Mumbai, India",
		"Bangalore, India",
		"Hong Kong",
		"Shanghai, China",
		"Beijing, China",

		"Sydney, Australia",

		"Johannesburg, South Africa",
		"Cape Town, South Africa",
		"Cairo, Egypt",
		"Nairobi, Kenya",
		"Lagos, Nigeria",

		"SÃ£o Paulo, Brazil"
	},
	Callback = function(value): string
		print("its a placebo effect easyyyyyy")
		Settings["RegionPriority"] = value
	end,

	Alphabetical = true,
	Default = {},
	Multiselect = true,
	Regex = function(itemToClean)
		local cleanedItem = itemToClean
		return cleanedItem or itemToClean
	end
})

configurations:Divider()

local serverhopSpeed = configurations:Slider({
	Name = "Delay between server hops",
	Min = 0,
	Max = 1,
	Callback = function(value): number
		Settings["ServerhopSpeed"] = value
	end,

	DisabledText = "Hey you cant use this!",
	FLAG = "slider",
	DisplayAsPercent = false,
	DecimalPlace = 2
})

configurations:Divider()

local label1 = configurations:Label("You can multi add brainrots by adding a comma [ , ] after each one!") 

Settings["Blacklist"] = Settings["Blacklist"] or {}

local blacklisted = configurations:Paragraph({
	Title = "Current Blacklisted Brainrots",
	Body = table.concat(Settings["Blacklist"], ", "),
})

local blacklistTextbox = configurations:TextBox({
	Name = "Blacklist Brainrots",
	Callback = function(value): string
		local trimmed = value:match("^%s*(.-)%s*$")
		if trimmed == "" then return end

		for entry in trimmed:gmatch("[^,]+") do
			local cleaned = entry:match("^%s*(.-)%s*$")
			if cleaned ~= "" and not table.find(Settings["Blacklist"], cleaned) then
				table.insert(Settings["Blacklist"], cleaned)
				Notification("blacklisted!", "[ " .. cleaned .. " ]")
			elseif table.find(Settings["Blacklist"], cleaned) then
				Notification("Already blacklisted!", "")
			end
		end

		updateParagraph(blacklisted, Settings["Blacklist"])
	end,
	OnLeave = true,
	PlaceHolderText = "Brainrot1 or brainrot1, brainrot 2, etc"
})

local removeBlacklistTextbox = configurations:TextBox({
	Name = "Remove Blacklisted Brainrots",
	Callback = function(value): string
		local trimmed = value:match("^%s*(.-)%s*$")
		if trimmed == "" then return end

		for entry in trimmed:gmatch("[^,]+") do
			local cleaned = entry:match("^%s*(.-)%s*$")
			if cleaned ~= "" then
				local index = table.find(Settings["Blacklist"], cleaned)
				if index then
					table.remove(Settings["Blacklist"], index)
					Notification("Removed from blacklisted!", "[ " .. cleaned .. " ]")
				else
					Notification("Not in blacklisted!", "[ " .. cleaned .. " ]")
				end
			end
		end

		updateParagraph(blacklisted, Settings["Blacklist"])
	end,
	OnLeave = true,
	PlaceHolderText = "Brainrot1 or brainrot1, brainrot 2, etc"
})

configurations:Divider()

Settings["Whitelist"] = Settings["Whitelist"] or {}

local whitelisted = configurations:Paragraph({
	Title = "Current Whitelisted Brainrots",
	Body = table.concat(Settings["Whitelist"], " "),
})

local whitelistTextbox = configurations:TextBox({
	Name = "Whitelist Brainrots",
	Callback = function(value): string
		local trimmed = value:match("^%s*(.-)%s*$")
		if trimmed == "" then return end

		for entry in trimmed:gmatch("[^,]+") do
			local cleaned = entry:match("^%s*(.-)%s*$")
			if cleaned ~= "" and not table.find(Settings["Whitelist"], cleaned) then
				table.insert(Settings["Whitelist"], cleaned)
				Notification("whitelisted!", "[ " .. cleaned .. " ]")
			elseif table.find(Settings["Whitelist"], cleaned) then
				Notification("Already whitelisted!", "")
			end
		end

		updateParagraph(whitelisted, Settings["Whitelist"])
	end,
	OnLeave = true,
	PlaceHolderText = "Brainrot1 or brainrot1, brainrot 2, etc"
})

local removeWhitelistTextbox = configurations:TextBox({
	Name = "Remove Whitelisted Brainrots",
	Callback = function(value): string
		local trimmed = value:match("^%s*(.-)%s*$")
		if trimmed == "" then Notification() return end

		for entry in trimmed:gmatch("[^,]+") do
			local cleaned = entry:match("^%s*(.-)%s*$")
			if cleaned ~= "" then
				local index = table.find(Settings["Whitelist"], cleaned)
				if index then
					table.remove(Settings["Whitelist"], index)
					Notification("Removed from whitelist!", "[ " .. cleaned .. " ]")
				else
					Notification("Not in whitelist!", "[ " .. cleaned .. " ]")
				end
			end
		end

		updateParagraph(whitelisted, Settings["Whitelist"])
	end,
	OnLeave = true,
	PlaceHolderText = "Brainrot1 or brainrot1, brainrot 2, etc"
})

configurations:Divider()
local label17 = configurations:Label("Find brainrots by their mutation! Useful if you are filling up an index") 

local mutationTarget = configurations:TextBox({
	Name = "Target Mutation",
	Callback = function(value): string
		Settings["MutationTarget"] = value
		Notification("Success!", "Target Mutation set to " .. value)
	end,

	OnlyNumbers = false,
	OnLeave = true,
	ClearTextOnFocus = false,
	PlaceHolderText = "Cursed, Radioactive, etc"
})

Settings["TargetBrainrots"] = Settings["TargetBrainrots"] or {}
local targetedBrainrots = configurations:Paragraph({
	Title = "Current Targeted Brainrots",
	Body = table.concat(Settings["TargetBrainrots"], " "),
})

local targetBrainrotTextbox = configurations:TextBox({
	Name = "Target Brainrots",
	Callback = function(value): string
		local trimmed = value:match("^%s*(.-)%s*$")
		if trimmed == "" then return end

		for entry in trimmed:gmatch("[^,]+") do
			local cleaned = entry:match("^%s*(.-)%s*$")
			if cleaned ~= "" and not table.find(Settings["TargetBrainrots"], cleaned) then
				table.insert(Settings["TargetBrainrots"], cleaned)
				Notification("Brainrot included!", "[ " .. cleaned .. " ]")
			elseif table.find(Settings["TargetBrainrots"], cleaned) then
				Notification("Already included!", "")
			end
		end

		updateParagraph(targetedBrainrots, Settings["TargetBrainrots"])
	end,
	OnLeave = true,
	PlaceHolderText = "Brainrot1 or brainrot1, brainrot 2, etc"
})

local DetargetTextbox = configurations:TextBox({
	Name = "Detarget Brainrots",
	Callback = function(value): string
		local trimmed = value:match("^%s*(.-)%s*$")
		if trimmed == "" then Notification() return end

		for entry in trimmed:gmatch("[^,]+") do
			local cleaned = entry:match("^%s*(.-)%s*$")
			if cleaned ~= "" then
				local index = table.find(Settings["TargetBrainrots"], cleaned)
				if index then
					table.remove(Settings["TargetBrainrots"], index)
					Notification("Removed from tagreted brainrots!", "[ " .. cleaned .. " ]")
				else
					Notification("Not in tagreted brainrots!", "[ " .. cleaned .. " ]")
				end
			end
		end

		updateParagraph(targetedBrainrots, Settings["TargetBrainrots"])
	end,
	OnLeave = true,
	PlaceHolderText = "Brainrot1 or brainrot1, brainrot 2, etc"
})

local discordConfiguration = window:Tab({
	Name = "Discord Configurations",

	Image = ""
})

local label1 = discordConfiguration:Label("Enabling this will remove your username, serverhop count, and serverid from the discord notification") 

local anonymity = discordConfiguration:Toggle({
	Name = "anonymity",
	Callback = function(value): boolean
		Settings["anonymity"] = value
	end,

	DisabledText = "Hey you cant use this!",
	FLAG = "toggle_anonymity",
	Default = false,
})

discordConfiguration:Divider()

local embedColorPicker = discordConfiguration:ColorPicker({
	Name = "Color Picker for the notification embed",
	Callback = function(color, transparency): Color3 & number
		local hex = Color3ToHex(color)
		Settings["embedColor"] = hex
	end,

	HideTransparency = true,
	Transparency = 0
})

local advancedSettings = window:Tab({
	Name = "Advanced Settings",

	Image = ""
})

local label5 = advancedSettings:Label("Prevents error messages from popping up") 

local RemoveErrorPrompts = advancedSettings:Toggle({
	Name = "RemoveErrorPrompts",
	Callback = function(value): boolean
		Settings["RemoveErrorPrompts"] = value
	end,

	DisabledText = "Hey you cant use this!",
	FLAG = "toggle_RemoveErrorPrompts",
	Default = true,
})

advancedSettings:Divider()

local label5 = advancedSettings:Label("Slightly beneficial if the game is high ccu or mid ccu") 

local ExcludefullServers = advancedSettings:Toggle({
	Name = "ExcludefullServers",
	Callback = function(value): boolean
		Settings["ExcludefullServers"] = value
	end,

	DisabledText = "Hey you cant use this!",
	FLAG = "toggle_ExcludefullServers",
	Default = false,
})

advancedSettings:Divider()

local label5 = advancedSettings:Label('saves every teleports that are attempted in jobid to "Attempts.txt" file') 

local SaveTeleportAttempts = advancedSettings:Toggle({
	Name = "SaveTeleportAttempts",
	Callback = function(value): boolean
		Settings["SaveTeleportAttempts"] = value
	end,

	DisabledText = "Hey you cant use this!",
	FLAG = "toggle_SaveTeleportAttempts",
	Default = false,
})

advancedSettings:Divider()

local APITextbox = advancedSettings:TextBox({
	Name = "API",
	Callback = function(value): string
		Settings["API"] = value
	end,

	FLAG = "APItextbox",
	Default = "https://games.roblox.com/v1/games/109983668079237/servers/Public?limit=100",
	OnlyNumbers = false,
	OnLeave = false,
	ClearTextOnFocus = false,
})

-- // LOADING CONFIGURATIONS // --
if Settings["HubtoLoad"] then
	HubToLoad:SetInput("loadstring(game:HttpGet(" .. Settings["HubtoLoad"] .. ")()")
end

if Settings["MoneyPerSecond"] then
	moneyPerSecond:SetInput(Settings["MoneyPerSecond"])
end

if Settings["ServerhopSpeed"] then
	serverhopSpeed:SetValue(Settings["ServerhopSpeed"])
end

if Settings["anonymity"] ~= nil then
	anonymity:SetValue(Settings["anonymity"])
end

if Settings["embedColor"] then
	embedColorPicker:SetColor(HexToColor3(Settings["embedColor"]))
end

if Settings["RemoveErrorPrompts"] ~= nil then
	RemoveErrorPrompts:SetValue(Settings["RemoveErrorPrompts"])
end

if Settings["ExcludefullServers"] ~= nil then
	ExcludefullServers:SetValue(Settings["ExcludefullServers"])
end

if Settings["SaveTeleportAttempts"] ~= nil then
	SaveTeleportAttempts:SetValue(Settings["SaveTeleportAttempts"])
end

if Settings["API"] then
	APITextbox:SetInput(Settings["API"])
end

if Settings["Blacklist"] then
	updateParagraph(blacklisted, Settings["Blacklist"])
end

if Settings["Whitelist"] then
	updateParagraph(whitelisted, Settings["Whitelist"])
end

if Settings["TargetBrainrots"] then
	updateParagraph(targetedBrainrots, Settings["TargetBrainrots"])
end

if Settings["MutationTarget"] then
	mutationTarget:SetInput(Settings["MutationTarget"])
end

if Settings["RegionPriority"] then
	dropdown:SelectItems(Settings["RegionPriority"])
end
